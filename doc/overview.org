* FMRT Mini SoC 蓝图
** 1 整体介绍

#+CAPTION: 图 1.1
[[file:img/overview.png]]

FMRT Mini SoC（以下简称 FMS） 以 FMRT Mini Core（以下简称 FMC） 为核心，加上存放程序和数据的存储器、串口通信的 UART、控制 LED 和开关的 GPIO，以及连接这些模块的总线构成的。

FMC 采用简单的五级流水线和简单的一级指令、数据 Cache，包含处理异常中断和冲突检测的部件。定时器与 UART 输出的中断请求信号直接连接到 FMC。FMS 还需要输入复位信号和时钟信号，由时钟模块提供。整体框架如图 1.1 所示。

FMS 的开发环境：FPGA 开发板，Quartus II 12.0，ModelSim-Altera 6.4a 。

** 2 FMRT Mini Core 的设计与实现

*** 2.1 FMC 的设计

**** 2.1.1 FMC 的流水线架构

**** 2.1.2 FMC 的指令集

这里把我们阅读 RISC-V 手册后，重新整理的结果写在这一小节。

*** 2.2 FMC 的实现 

** 3 总线的设计与实现

FMS 使用的总线为使用时钟信号同步数据传输的同步总线。

*** 3.1 总线的设计

1. 请求总线使用权
2. 取得总线使用权
3. 总线访问开始
4. 来自总线从属的应答
5. 总线访问结束并释放总线使用权

*** 3.2 总线的实现

** 4 存储器的设计与实现

*** 4.1 内存
使用 FPGA 的 SRAM，位于核心板 U6，容量 256MB。

*** 4.2 ROM
使用 FPGA 的 EEPROM，位于核心板 U3，容量 256Byte，用来存放引导程序。ROM 地址映射到地址空间 0 处，FMC 启动后从 0号地址开始执行程序。

** 5 I/0 的设计与实现

FMS 的 I/O 有三种，分别是测量时间用的定时器、串口通信规范 UART，以及控制 LED、开关用的 GPIO。

*** 5.1 定时器

将要设计的定时器具有两种动作模式：一种是经过设定时间后向CPU 请求一
次中断即完成操作的单次定时模式，另一种是每经过设定时间就向CPU 请求一次中断
的循环定时模式。单次定时器在只进行一次时间测量时使用，循环定时器在需要执行周
期性操作时使用。

**** 5.1.1 定时器的设计

**** 5.1.2 定时器的实现

*** 5.2 UART

**** 5.2.1 UART 的设计

**** 5.2.2 UART 的实现

*** 5.3 GPIO

**** 5.3.1 GPIO 的设计

**** 5.3.2 GPIO 的实现

** 6 FMRT Mini SoC 整体连接

*** 6.1 各模块的连接 

*** 6.2 时钟模块的实现

*** 6.3 顶层模块的实现

** 7 FMRT Mini SoC 的仿真

*** 7.1 仿真模型的编写

*** 7.2 Testbench 的编写

*** 7.3 执行仿真

** 8 编程

*** 8.1 开发环境

*** 8.2 制作一个实用程序
